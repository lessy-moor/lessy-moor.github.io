<html>
<head>
	<title>Создать виджет для сообщества</title>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="https://vk.com/js/api/xd_connection.js?2"></script>
	<style>
		#content { display: none; }
	</style>
</head>
<body>
	<h1>Создать виджет для сообщества</h1>
	<h2>Панель управления виджетом 6</h2>
	<p id="message"></p>
	<div id="content">
		<button onclick="VK.callMethod('showGroupSettingsBox', 0);">Запросить права доступа</button>
		<button onclick="Preview();">Предварительный просмотр виджета</button>
		<br><br><br><br>
	</div>
	<script type="text/javascript">
		var code={ 
			"title": "sgesgesges",
			"title_url": "https://vk.com/",
			"head":
			[
				{ "text": "sfesgges" },
				{ "text": "sgesge" }
			],
			"body":
			[
				[
					{ "text": "segges" },
					{ "text": "segseg" }
				],
				[
					{ "text": "segesgg" },
					{ "text": "esgsegg" }
				]
			]
		};
		code=JSON.stringify(code);
		//Инициализация приложения
		VK.init(function() { 
			 $("#message").append("Подключение к API выполнено успешно!<br><br>");
			 $("#content").show();
		}, function() { 
			 $("#message").append("Ошибка при подключении к API<br><br>");
		}, '5.78'); 
		//Предпросмотр и установка виджета
		function Preview() {
			$("#message").append("Запрошен предпросмотр виджета<br><br>");
			//alert(VK.callMethod('showAppWidgetPreviewBox', 'text', 'return '+window.code+';'));
			alert('return '+window.code+';');
		}
	</script>
</body>
</html>